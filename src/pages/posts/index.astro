---
import BlogCard from '../../components/BlogCard.astro';
import Layout from '../../components/Layout.astro';
import Markdown from '../../components/Markdown.astro';
import * as postsIntro from '../../../content/posts-intro.md';
import config from '../../lib/config';
import { getPostId } from '../../lib/content-utils';

const posts = await Astro.glob('../../../content/posts/*.md');
const sortedPosts = posts.sort((a, b) => {
  return a.date > b.date ? 1 : -1;
});
---

<Layout
  title={`Blog Posts - ${config.MY_NAME}`}
  description="List of blog posts I've written about topics that interest me."
>
  <header>
    <h1>Blog Posts</h1>
  </header>

  <section>
    <Markdown content={postsIntro.compiledContent()} />
  </section>

  <section>
    <h3>
      {
        sortedPosts.map((post) => (
          <BlogCard
            url={`/posts/${getPostId(post.file)}`}
            title={post.frontmatter.title}
            date={post.frontmatter.date}
            description={post.frontmatter.description}
          />
        ))
      }
    </h3>
  </section>
</Layout>
